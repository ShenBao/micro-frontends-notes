# 微前端分层设计

## 微前端分层

| 分层名称 | 职责 |
| --- | --- |
| apps | 业务表现层，独立项目对业务模块版本组织与组装。 |
| mods | 业务模块层，独立模块的业务实现。 自管理、自测试、独立出包。 |
| frm | 系统框架层，提供系统容器及模块加载器、执行器、调度中心 |
| deps | 框架依赖层，专注Auth、ACL、Theme、Cache、Form等 |
| libs | 公共库层，包含常用JS算法、方法、TS类型扩展等 |

## libs（公共库层)

| boost （语言增强） | control（公共控件） | https（请求封装） |
| --- | --- | --- |
| 对常见 Typescript 类型的封装。例如： String.forChar(()=>)、Array.toObject 等方法的封装。| 对系统中经常使用的控件进行封装，并对外提供 CSS 样式控制接口。如自定义 UI 组件库 | 对 Rest 请求和数据建模去业务后的事件抽象处理。包括 TS 对象生成、路由前缀管理、消息包装盒装箱拆箱、数据加密解密 |

## deps （框架依赖层）

| i18n（国际化）| theme（主题系统） | directive（指令框架）|
| --- | --- | --- |
| 提供字符中占位资源管理，统一管理字面值，为相同控件、组件、模块的个性化配置提供支持。 | 提供样式工具规范统一尺寸、配色、间距等，抽取公共控件或布局样式，避免重复开发和维护。| 提供部分公共指令，例如时间转换，以及对上层应用可扩展的指令模版和规范。主要用于简化和统一页面操作和响应。 ｜

| service （服务框架）| pip （数据管道）| layout （布局框架） |
| --- | --- | --- |
| 提供无页面的服务机制以及部分公共且常用的服务，例如 http 监听服务、状态管理器等。 | 提供可迭代对象管道、数据包装器管道、安全 HTML 管道等通用管道，同时提供管道框架（非必要）。| 提供布局配置的容器和执行器、并提供上左右、单页面、上下、左右四种默认布局。向上层提供扩展通道，允许自定义布局。|

| event （事件总线）| auth （用户认证）| cal （访问控制） |
| --- | --- | --- |
|  提供事件、消息的统一处理，并提供状态管理以及注册监听机制。用于保障存在多场最、多状态、互斥状态等事件分发的管理。  |  提供统一的用户认证服务、Token 更新管理、路由守卫等服务功能。支持自定义鉴权和事件监听。 | 提供基于角色的权限访问控制，提供以资源为基础的细粒度访问控制、同时提供细粒度路由守卫能力。|

| form（动态表单） | cache（缓存管理） | chart（图表管理） |
| --- | --- | --- |
| 提供统一风格和功能的表单工具、定制化呈现的表单工具、统一表单交互的操作以及規范用法。 | 提供各级别缓存的统一读写接口、支持缓存变更监听管理机制以及鉴权管理的请求、写入管理。 | 提供统一的图表绘制工具集合、提供通用的图表管理工具，以及規范的图表数据规范和协议。 |

## frm（系统框架层）

|  menu（系统菜单）  |  login（登陆模块）  |  user （个人中心）  |
| --- | --- | --- |
|  提供系统菜单的容器，以及对应配置方式管理的动态菜单注入机制，菜单事件监听容器。  |  提供分角色登陆系统，管理记录登录信息和全局项目信息以及个性化相关的其他配置。  |  提供用户个人信息，包含个性化配置数据、消息管理、通知管理以及事件监听和分发。  |

|  layout （布局容器）  |  drawer（抽屉容器）  |  modal（弹框容器）  |
| --- | --- | --- |
｜  提供可动态注入的布局容器，以及容器内部的互斥管理器和对应的事件中心、消息中心。 |  提供可动态注入的抽屉容器，以及容器内部的互斥状态管理器和对应的事件中心、消息中心。 | 提供可动态注入的弹框容器，以及容器内部的互斥管理器和对应的事件中心、消息中心。 |

|  loader （模块加载器）  |  router（路由中心)  |  auth（鉴权中心)  |
| --- | --- | --- |
|  提供子模块动态加载卸载器，以及 WebComponent 组件解析器和注入器能力。  |  框架内统一的路由管理器、以及记录管理器等、用于路由统一拦截管理、路由历史记录等功能。  |  提供框架内所有认证与访问控制在内的鉴权管理，模块包括http、路由、按钮状态等控制。  |

|  tab（页签容器）  |  event（事件中心)  |  config（配置中心)  |
| --- | --- | --- |
|  提供可动态注入的页签容器，以及容器内部的互斥管理器和对应的事件中心、消息中心。 |  提供容器无关的业务事件注册与分发中心，支持子模块内通信、模块间通信和事件分发。  |  提供系统级别的配置管理中心，例如系统菜单数据来源、个人中心数据来源源，弹窗浮动状态等  |
